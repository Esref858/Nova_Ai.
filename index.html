<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, maximum-scale=1"/>
<title>Nova AI ‚Äî Future Interface</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    /* –û—Å–Ω–æ–≤–Ω—ã–µ —Ü–≤–µ—Ç–∞ */
    --bg-app: #0e0e0e;
    --bg-panel: #1e1f20;
    --text-primary: #e3e3e3;
    --text-secondary: #a8a8a8;
    
    /* –§–∏—Ä–º–µ–Ω–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è –±—Ä–µ–Ω–¥–∞ Nova */
    --nova-grad: linear-gradient(135deg, #4285f4, #9b51e0, #ff5c5c);
    
    /* –†–∞–∑–º–µ—Ä—ã */
    --radius-input: 32px;
  }

  * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
  
  body {
    margin: 0;
    background: var(--bg-app);
    color: var(--text-primary);
    font-family: 'Inter', sans-serif;
    height: 100vh;
    display: flex;
    overflow: hidden;
  }

  /* --- SIDEBAR (–ò—Å—Ç–æ—Ä–∏—è) --- */
  .sidebar {
    width: 280px;
    background: #131314;
    display: flex;
    flex-direction: column;
    border-right: 1px solid rgba(255,255,255,0.05);
    transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 100;
    padding: 20px 10px;
  }
  
  .new-chat-btn {
    background: #1b1b1b;
    color: #c4c7c5;
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: 50px;
    padding: 12px 20px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    display: flex; align-items: center; gap: 10px;
    transition: all 0.2s;
    margin-bottom: 20px;
  }
  .new-chat-btn:hover { background: #28292a; color: #fff; }
  .new-chat-btn span { font-size: 20px; background: var(--nova-grad); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

  .history-list {
    flex: 1;
    overflow-y: auto;
    display: flex; flex-direction: column; gap: 4px;
  }
  .history-item {
    padding: 10px 16px;
    border-radius: 50px;
    font-size: 14px;
    color: var(--text-secondary);
    cursor: pointer;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    transition: 0.2s;
  }
  .history-item:hover { background: #28292a; color: #fff; }
  .history-item.active { background: #1c1c1e; color: #a8c7fa; font-weight: 500; border: 1px solid rgba(66, 133, 244, 0.3); }

  .sidebar-footer {
    margin-top: auto; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.05);
    display: flex; gap: 8px;
  }
  .icon-btn {
    background: transparent; border: none; color: var(--text-secondary);
    cursor: pointer; padding: 8px; border-radius: 50%;
    transition: 0.2s;
  }
  .icon-btn:hover { background: rgba(255,255,255,0.1); color: #fff; }

  /* --- MAIN CONTENT --- */
  .main {
    flex: 1;
    display: flex;
    flex-direction: column;
    position: relative;
    background: var(--bg-app);
  }

  /* --- HEADER MOBILE --- */
  .mobile-header {
    display: none; /* –°–∫—Ä—ã—Ç–æ –Ω–∞ –ü–ö */
    align-items: center;
    justify-content: space-between;
    padding: 15px 20px;
    position: absolute; top: 0; left: 0; right: 0;
    z-index: 50;
    /* –≠—Ñ—Ñ–µ–∫—Ç —Å—Ç–µ–∫–ª–∞ */
    background: rgba(14, 14, 14, 0.8);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border-bottom: 1px solid rgba(255,255,255,0.05);
  }
  
  .brand-mobile {
    font-weight: 700; 
    font-size: 20px;
    background: var(--nova-grad);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    letter-spacing: -0.5px;
  }
  
  /* –ö–Ω–æ–ø–∫–∞ "–¢—Ä–∏ –ª–∏–Ω–∏–∏" */
  .hamburger {
    background: transparent; border: none; cursor: pointer; padding: 0;
    width: 24px; height: 24px; position: relative;
    display: flex; flex-direction: column; justify-content: space-around;
    padding: 2px 0;
  }
  .hamburger span {
    width: 100%; height: 2px; background: #e3e3e3; border-radius: 2px;
    transition: 0.3s;
  }

  /* --- CHAT AREA --- */
  .chat-scroll {
    flex: 1;
    overflow-y: auto;
    padding: 80px 20px 120px 20px; /* –û—Ç—Å—Ç—É–ø—ã –ø–æ–¥ —Ö–µ–¥–µ—Ä –∏ –∏–Ω–ø—É—Ç */
    display: flex; flex-direction: column; gap: 30px;
    scroll-behavior: smooth;
  }
  
  /* –°–æ–æ–±—â–µ–Ω–∏—è */
  .msg-group {
    display: flex; gap: 16px;
    max-width: 760px;
    margin: 0 auto;
    width: 100%;
    animation: fadeIn 0.4s ease;
  }
  .msg-group.user { flex-direction: row-reverse; }

  .avatar {
    width: 32px; height: 32px; border-radius: 50%; flex-shrink: 0;
    display: flex; align-items: center; justify-content: center;
    font-size: 16px; font-weight: 700;
  }
  .avatar.ai { 
    background: transparent;
    border: 1px solid rgba(255,255,255,0.1);
  }
  .avatar.ai svg { width: 20px; height: 20px; fill: url(#novaGradIcon); }
  .avatar.user { background: #444746; color: #fff; font-weight: 500; }

  .bubble {
    font-size: 16px;
    line-height: 1.6;
    color: var(--text-primary);
  }
  .user .bubble {
    background: #2b2c2d;
    padding: 12px 20px;
    border-radius: 24px;
    border-bottom-right-radius: 6px;
  }
  .bot .bubble {
    background: transparent;
    padding: 4px 0;
  }

  /* --- –ê–ù–ò–ú–ê–¶–ò–Ø "–ö–†–£–ñ–ò–¢–°–Ø –ö–û–ì–î–ê –î–£–ú–ê–ï–®–¨" --- */
  .thinking-container {
    display: flex; align-items: center; gap: 12px; padding: 5px 0;
  }
  .spinner-ring {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: conic-gradient(
      from 0deg,
      #4285f4, #db4437, #f4b400, #0f9d58, #4285f4
    );
    -webkit-mask: radial-gradient(farthest-side, transparent calc(100% - 3px), #fff calc(100% - 3px + 0.5px));
    mask: radial-gradient(farthest-side, transparent calc(100% - 3px), #fff calc(100% - 3px + 0.5px));
    animation: spinRing 1.2s linear infinite;
  }
  .thinking-text {
    font-size: 14px; color: var(--text-secondary);
    animation: pulseText 1.5s ease-in-out infinite;
  }

  @keyframes spinRing { to { transform: rotate(360deg); } }
  @keyframes pulseText { 0%, 100% { opacity: 0.6; } 50% { opacity: 1; } }
  @keyframes fadeIn { from{opacity:0; transform:translateY(10px)} to{opacity:1; transform:translateY(0)} }

  /* --- INPUT AREA --- */
  .input-container {
    position: absolute; bottom: 0; left: 0; right: 0;
    padding: 24px;
    display: flex; justify-content: center;
    background: linear-gradient(to top, #0e0e0e 40%, transparent);
    z-index: 20;
  }
  .input-box {
    background: #1e1f20;
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: var(--radius-input);
    width: 100%; max-width: 760px;
    display: flex; align-items: flex-end;
    padding: 8px;
    transition: 0.2s;
    box-shadow: 0 4px 20px rgba(0,0,0,0.2);
    backdrop-filter: blur(10px);
  }
  .input-box:focus-within {
    background: #252627;
    border-color: rgba(255,255,255,0.25);
    box-shadow: 0 8px 30px rgba(0,0,0,0.4);
  }
  
  textarea {
    flex: 1; background: transparent; border: none; color: #fff;
    padding: 14px 18px; font-size: 16px; font-family: inherit;
    resize: none; max-height: 180px; outline: none;
    height: 50px; /* start height */
    line-height: 1.5;
    
    /* === –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –°–ö–†–´–í–ê–ï–ú –°–ö–†–û–õ–õ–ë–ê–† === */
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE/Edge */
  }
  /* –°–∫—Ä—ã–≤–∞–µ–º —Å–∫—Ä–æ–ª–ª–±–∞—Ä –¥–ª—è Chrome/Safari/Opera */
  textarea::-webkit-scrollbar {
    display: none;
  }
  
  textarea::placeholder { color: #787878; }
  
  .send-btn {
    width: 46px; height: 46px; border-radius: 50%;
    background: #fff; border: none; cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    transition: 0.2s;
    margin-bottom: 2px; margin-right: 2px;
    flex-shrink: 0;
  }
  .send-btn:hover { transform: scale(1.05); background: var(--nova-grad); }
  .send-btn:hover svg { fill: white; }
  .send-btn svg { fill: #0e0e0e; width: 22px; height: 22px; margin-left: 2px; transition: 0.2s; }

  /* --- MOBILE ADAPTATION --- */
  .overlay {
    position: fixed; inset: 0; background: rgba(0,0,0,0.7);
    opacity: 0; pointer-events: none; transition: 0.3s; z-index: 90;
    backdrop-filter: blur(5px);
  }
  .overlay.active { opacity: 1; pointer-events: auto; }

  @media (max-width: 768px) {
    .sidebar {
      position: fixed; left: -100%; top: 0; bottom: 0;
      width: 280px; box-shadow: 10px 0 40px rgba(0,0,0,0.5);
    }
    .sidebar.open { transform: translateX(100%); left: 0; }
    .mobile-header { display: flex; }
    .chat-scroll { padding-top: 80px; } /* –ú–µ—Å—Ç–æ –ø–æ–¥ —Ö–µ–¥–µ—Ä */
    .msg-group { max-width: 100%; }
    .input-container { padding: 16px; }
  }

  /* --- EMPTY STATE --- */
  .empty-state {
    position: absolute; top: 40%; left: 50%; transform: translate(-50%, -50%);
    text-align: center; color: var(--text-secondary); pointer-events: none;
    width: 100%; padding: 20px;
  }
  .empty-logo {
    font-size: 42px; font-weight: 700;
    background: var(--nova-grad);
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    margin-bottom: 16px; letter-spacing: -1px;
  }
</style>
</head>
<body>

<div class="overlay" id="overlay"></div>

<aside class="sidebar" id="sidebar">
  <button class="new-chat-btn" id="btn-new">
    <span>+</span> Nova Chat
  </button>

  <div style="font-size:12px; font-weight:600; color:#787878; padding:0 10px 10px; letter-spacing: 0.5px;">–ò–°–¢–û–†–ò–Ø</div>
  <div class="history-list" id="history"></div>

  <div class="sidebar-footer">
    <button class="icon-btn" id="btn-clear" title="–£–¥–∞–ª–∏—Ç—å –≤—Å—ë">üóëÔ∏è</button>
    <div style="flex:1"></div>
    <span style="font-size:12px; color:#555; padding:8px;">v2.2 Clean</span>
  </div>
</aside>

<main class="main">
  <header class="mobile-header">
    <button class="hamburger" id="hamburger">
      <span></span><span></span><span></span>
    </button>
    <div class="brand-mobile">Nova AI</div>
    <div style="width:24px"></div>
  </header>

  <div class="chat-scroll" id="messages">
    <div class="empty-state" id="welcome-msg">
      <div class="empty-logo">–ü—Ä–∏–≤–µ—Ç, —è Nova AI</div>
      <div style="font-size: 18px; opacity:0.7; line-height: 1.5;">–ó–∞–¥–∞–π –º–Ω–µ –ª—é–±–æ–π –≤–æ–ø—Ä–æ—Å,<br>—è –≥–æ—Ç–æ–≤–∞ –ø–æ–º–æ—á—å.</div>
    </div>
  </div>

  <div class="input-container">
    <div class="input-box">
      <textarea id="input" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ Nova..." rows="1"></textarea>
      <button class="send-btn" id="btn-send">
        <svg viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
      </button>
    </div>
  </div>
</main>

<svg width="0" height="0" style="position:absolute">
  <defs>
    <linearGradient id="novaGradIcon" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4285f4" />
      <stop offset="50%" style="stop-color:#9b51e0" />
      <stop offset="100%" style="stop-color:#ff5c5c" />
    </linearGradient>
  </defs>
</svg>

<script>
/* === –ù–ê–°–¢–†–û–ô–ö–ò === */
const OPENAI_KEY = "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";

/* === –≠–õ–ï–ú–ï–ù–¢–´ === */
const el = {
  msgs: document.getElementById('messages'),
  input: document.getElementById('input'),
  btnSend: document.getElementById('btn-send'),
  btnNew: document.getElementById('btn-new'),
  btnClear: document.getElementById('btn-clear'),
  hamburger: document.getElementById('hamburger'),
  sidebar: document.getElementById('sidebar'),
  overlay: document.getElementById('overlay'),
  history: document.getElementById('history'),
  welcome: document.getElementById('welcome-msg')
};

let state = { chats: [], current: -1 };

/* === –§–£–ù–ö–¶–ò–ò –ú–û–ë–ò–õ–¨–ù–û–ì–û –ú–ï–ù–Æ === */
function toggleMenu() {
  const isOpen = el.sidebar.classList.contains('open');
  el.sidebar.classList.toggle('open', !isOpen);
  el.overlay.classList.toggle('active', !isOpen);
}
el.hamburger.onclick = toggleMenu;
el.overlay.onclick = toggleMenu;

/* === –õ–û–ì–ò–ö–ê –ß–ê–¢–ê === */
function save() { localStorage.setItem('nova_ai_db_v3', JSON.stringify(state)); }
function load() {
  const d = localStorage.getItem('nova_ai_db_v3');
  if(d) {
    try { state = JSON.parse(d); } catch(e){ state = {chats:[], current:-1}; }
    renderHistory();
    renderChat();
  }
}

function renderHistory() {
  el.history.innerHTML = '';
  state.chats.forEach((c, i) => {
    const div = document.createElement('div');
    div.className = `history-item ${i === state.current ? 'active' : ''}`;
    div.textContent = c.name || '–ù–æ–≤—ã–π —á–∞—Ç';
    div.onclick = () => { state.current = i; renderHistory(); renderChat(); if(window.innerWidth<=768) toggleMenu(); };
    el.history.appendChild(div);
  });
}

function renderChat() {
  el.msgs.innerHTML = '';
  if(state.current < 0 || state.chats[state.current].messages.length === 0) {
    el.msgs.appendChild(el.welcome);
    el.welcome.style.display = 'block';
    return;
  }
  el.welcome.style.display = 'none';
  state.chats[state.current].messages.forEach(m => createMsgNode(m.role, m.text));
  scrollToBottom();
}

function createMsgNode(role, text) {
  const group = document.createElement('div');
  group.className = `msg-group ${role === 'user' ? 'user' : 'bot'}`;
  
  const ava = document.createElement('div');
  ava.className = `avatar ${role === 'user' ? 'user' : 'ai'}`;
  if(role==='bot') ava.innerHTML = `<svg viewBox="0 0 24 24"><path d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M12,6A6,6 0 0,1 18,12A6,6 0 0,1 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6M12,8A4,4 0 0,0 8,12A4,4 0 0,0 12,16A4,4 0 0,0 16,12A4,4 0 0,0 12,8Z"/></svg>`;
  else ava.textContent = 'E'; 
  
  const bubble = document.createElement('div');
  bubble.className = 'bubble';
  bubble.innerHTML = formatText(text);

  group.appendChild(ava);
  group.appendChild(bubble);
  el.msgs.appendChild(group);
}

function createLoader() {
  const loader = document.createElement('div');
  loader.id = 'temp-loader';
  loader.className = 'msg-group bot';
  loader.innerHTML = `
    <div class="avatar ai">
       <svg viewBox="0 0 24 24"><path d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M12,6A6,6 0 0,1 18,12A6,6 0 0,1 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6M12,8A4,4 0 0,0 8,12A4,4 0 0,0 12,16A4,4 0 0,0 16,12A4,4 0 0,0 12,8Z"/></svg>
    </div>
    <div class="bubble">
      <div class="thinking-container">
        <div class="spinner-ring"></div>
        <div class="thinking-text">Nova –¥—É–º–∞–µ—Ç...</div>
      </div>
    </div>
  `;
  el.msgs.appendChild(loader);
  scrollToBottom();
}

function scrollToBottom() {
  el.msgs.scrollTop = el.msgs.scrollHeight;
}

function formatText(t) {
  return t.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>').replace(/\n/g, '<br>');
}

/* === –û–¢–ü–†–ê–í–ö–ê === */
async function send() {
  const txt = el.input.value.trim();
  if(!txt) return;

  if(state.current < 0) {
    state.chats.push({ name: txt.slice(0, 25), messages: [] });
    state.current = state.chats.length - 1;
    renderHistory();
  }

  state.chats[state.current].messages.push({ role: 'user', text: txt });
  el.input.value = '';
  el.input.style.height = '50px';
  renderChat();

  createLoader();

  try {
    let reply = '';
    if(OPENAI_KEY && OPENAI_KEY.length > 20) {
      const res = await fetch('https://api.openai.com/v1/chat/completions', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${OPENAI_KEY}` },
        body: JSON.stringify({
          model: "gpt-4o-mini",
          messages: [{role: "user", content: txt}],
          max_tokens: 1000
        })
      });
      const data = await res.json();
      reply = data.choices?.[0]?.message?.content || '–û—à–∏–±–∫–∞ API';
    } else {
      await new Promise(r => setTimeout(r, 2500));
      reply = `[–õ–æ–∫–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç Nova AI] –í–∏–∂—É, —Å–∫—Ä–æ–ª–ª–±–∞—Ä –∏—Å—á–µ–∑! –¢–µ–ø–µ—Ä—å –≤—Å–µ —á–∏—Å—Ç–æ.`;
    }

    const loader = document.getElementById('temp-loader');
    if(loader) loader.remove();
    
    state.chats[state.current].messages.push({ role: 'bot', text: reply });
    renderChat();
    save();

  } catch(e) {
    const loader = document.getElementById('temp-loader');
    if(loader) loader.remove();
    alert('–û—à–∏–±–∫–∞: ' + e);
  }
}

el.btnSend.onclick = send;
el.input.onkeydown = (e) => { if(e.key==='Enter' && !e.shiftKey) { e.preventDefault(); send(); }};
el.input.oninput = function() {
  this.style.height = 'auto';
  this.style.height = (this.scrollHeight) + 'px';
};

el.btnNew.onclick = () => {
  state.current = -1;
  renderHistory();
  renderChat();
  if(window.innerWidth <= 768) toggleMenu();
};

el.btnClear.onclick = () => {
  if(confirm('–£–¥–∞–ª–∏—Ç—å –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é?')) {
    state.chats = []; state.current = -1;
    save(); renderHistory(); renderChat();
  }
};

load();
</script>
</body>
</html>